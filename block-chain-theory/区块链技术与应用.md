<!-- # 区块链技术与应用 -->
# Blockchain Technologgy and Application

<!-- 区块链的本质 -->
The Nature of Blockchain

<!-- 下一代的价值互联网 -->
The Next Generation of Value Internet

<!-- 世界上最慢的数据库 -->
The Slowest Database in the World

<!-- 区块链领域的专家 -->
Experts in the Field of Blockchain

<!-- 现在入门还不晚 -->
It's not too late to get started

<!-- 区块链不等于比特币 -->
Blockchain is not equal to Bitcoin



<!-- 课程信息 -->
## Course Information

<!-- 比特币和以太坊两种数字货币 -->
Bitcoin and Ethereum

<!-- - 数组 链表 二叉树 哈希函数 -->
- Array Linked List Binary Tree Hash Function

- Bitcoin and Cryptocurrency Technologies Comprehensive Introduction

<!-- - 以太坊的白皮书 黄皮书 源代码 -->
- Ethereum White Paper, Yellow Paper, and Source Code

<!-- - Solidity 文档 -->
- Solidity Documentation



<!-- 课程大纲 -->
## Course Outline

<!-- - 比特币 -->
- Bitcoin
  <!-- - 密码学基础 -->
  - Fundamentals of Cryptography
  <!-- - 比特币的数据结构 -->
  - Data Structure of Bitcoin
  <!-- - 共识协议和系统实现 -->
  - Consensus Protocol and System Implementation
  <!-- - 挖矿算法和难度调整 -->
  - Mining Algorithm and Difficulty Adjustment
  <!-- - 比特币脚本 -->
  - Bitcoin Script
  <!-- - 软件分叉和硬件分叉 -->
  - Software Bifurcation and Hardware Bifurcation
  <!-- - 匿名和隐私保护 -->
  - Anonymity and Privacy Protection

<!-- - 以太坊 -->
- Ethereum
  <!-- - 概述：基于账户的分布式账本 -->
  - Overview: Account Based Distributed Ledger
  <!-- - 数据结构：状态树，交易树，收据树 -->
  - Data Structure: Status Tree, Transaction Tree, and Receipt Tree
  <!-- - GHOST协议 -->
  - GHOST Protocol
  <!-- - 挖矿：memory-hard mining puzzle -->
  - Mining: Memory Hard Mining Puzzle
  <!-- - 挖矿难度调整 -->
  - Adjustment of Mining Difficulty
  <!-- - 权益证明 -->
  - Equity Certificate
    - Casper the Friendly Finality Gadget (FFG)
  <!-- - 智能合约 -->
  - Smart Contract

<!-- - 总结与展望 -->
- Summary and Outlook



<!-- ## 1 比特币中的密码学原理 -->
## 1. Cryptographic Principles in Bitcoin


<!-- 比特币被称为加密货币Crypto-currency 加密货币 -->
Bitcoin is Called Cryptocurrency  

<!-- 区块链上内容都是公开的，包括区块的地址，转账的金额 -->
The content on the blockchain is public, including the address of the block and the amount transferred

<!-- 比特币主要用到了密码学中的两个功能：-->
Bitcoin mainly uses two functions in cryptography:
<!-- - 哈希 --> 
- Hash
<!-- - 签名 -->
- Signature
  

<br/>

<!-- 1. 密码学中用到的哈希函数称为 cryptographic hash function -->
1. Hash functions used in cryptography are called cryptographic hash functions

  <!-- 性质: -->
Nature:

<!-- - collision resistance 哈希碰撞 (Collision free) 没有什么高效的方法制作哈希碰撞 -->
- Collision resistance hash collision (Collision free), there is no efficient method to make hash collision
  <!-- - x != y, H(x) = H(y) 两个不同的输入，输出却是相等的，他是不可避免的，这就叫做哈希碰撞，两个不同的输入映射到同一个输出，一般来说这是不可编码的 -->
  - x != y. H (x)=H (y), Two different inputs, but the output is equal, which is inevitable. This is called hash collision. Two different inputs map to the same output, which is generally uncodable
  <!-- - 输入空间远远大于输出空间，256为的哈希值 输出空间2^256 -->
  - The input space is much larger than the output space. 256 is the hash value output space of 2 ^ 256
  <!-- - 鸽笼原理 -->
  - Pigeon cage principle
  <!-- - 通过蛮力方法破解 brute - force -->
  - Break brute - force by brute force method 
  <!-- - 如果输入空间比较大 用这种方法在实际中工作量太大了 -->
  - If the input space is large, this method is too much work in practice
  <!-- - 用途： 求digest , H(m) -- digest -->
  - Purpose: to find digest, H (m) -- digest
  <!-- - 没有办法篡改内容，而又不被检测出来 -->
  - There is no way to tamper with the content without being detected
  <!-- - 没有那个函数能在数学上证明是collision resistance 的 -->
  - No function can be mathematically proved to be collision persistence
  <!-- - MD5 现在已经不安全了，可以人为的制造哈希碰撞 -->
  - MD5 is no longer safe, and it can artificially create hash collisions

<!-- - Hiding 哈希函数的计算过程是单向的是不可逆的 -->
- The calculation process of Hiding hash function is unidirectional and irreversible
  - x ----> H(x) , H(x) ---\\\\-> x 
  <!-- - 蛮力求解 --> 
  - Bruce force solution
  <!-- - 前提是输入空间是足够大，分布均匀, 各种取值的概率是相同的 -->
  - The precondition is that the input space is large enough, the distribution is uniform, and the probabilities of various values are the same
  <!-- - 一般在后面拼接随机数 ----  H( x|| nonce) -->
  - Generally, random numbers are spliced at the back ----  H( x|| nonce)

<!-- - Puzzle friedly 比特币中用到的哈希函数的第三个性质 -->
- Third property of hash function used in puzzle friendly Bitcoin
  <!-- - 哈希值的计算，事先是不可预测的 -->
  - The calculation of hash value is unpredictable in advance
  <!-- - （000000000000.....0000多少位）XXXXXXX-------XXXXX 需要一个一个去试没有什么捷径 -->
  - (0000000000000.....0000 digits) XXXXXXX------XXXXX needs to try one by one. There is no shortcut
  <!-- - H(block header + Nonce) <= target  挖矿就是试不同的nonce 使得这个公式成立 小于置顶的阈值 -->
  - H (block header + Nonce) <= target mining is to try different nonces to make this formula hold less than the threshold value of topping
  <!-- - 挖矿的过程没有捷径 只能一个一个的去试 -->
  - There is no shortcut in the process of mining. You can only try one by one
  <!-- - 这个过程叫做工作量证明 proof of work -->
  - This process is called proof of work
  <!-- - 挖矿很难 验证很容易 -->
  - Mining is difficult to verify
  - Difficuly to solve, but easy to proof
  <!-- - SHA - 256  (Secure Hash Algorithm ) 安全哈希算法 sha256 -->
  - SHA - 256 (Secure Hash Algorithm)



Digital Commitment (Digital Equivalent of a Sealed Envelope)

<!-- - 由 collision resistance 和hidiing 实现 -->
- Implemented by collaboration resistance and hiding
<!-- - 预测结果不能提前公开 -->
- Forecast results cannot be disclosed in advance
- Sealed envelope 


<br/>

<!-- 签名 -->
2. Signature

<!-- - 比特币系统中的账户管理 -->
- Account management in Bitcoin system
<!-- - 开户的过程很简单 就是创建一个公钥和私钥的对 -->
- The process of opening an account is very simple, which is to create a pair of public key and private key
<!-- - (public key, private key) --- 比特币中代表一个账户 -->
- (Public key, private key) --- Bitcoin represents an account
<!-- - asymmtric encryption algorithm 非对称加密算法 不是用一个秘钥，而是一对秘钥 -->
- Asymmetric encryption algorithm does not use one secret key, but a pair of secret keys
- Encyption key 
<!-- - 堆成加密算法，加密和解密用的是同一种秘钥 -->
- Heap the encryption algorithm. The encryption and decryption use the same secret key
<!-- - 加密用的公钥不是保密的 是公开的 -->
- The public key used for encryption is not secret but public
<!-- - 签名用的是私钥，验证签名用的是这个人的公钥 -->
- The signature uses the private key, and the verification signature uses the public key of this person
- A good source of randowness
<!-- - 生成公私钥要使用好的随机源还有在签名时也要用好的随机源 -->
- Good random sources should be used to generate public and private keys, and good random sources should also be used when signing



<!-- # 比特币中的密码学原理 -->
## 2. Cryptographic Principles in Bitcoin

<!-- 比特币被称为加密货币 (Crypto-Currency) -->
Bitcoin is Called Crypto Currency

<!-- 区块链上内容都是公开的，包括区块的地址，转账的金额。-->
The content on the blockchain is public, including the address of the block and the amount transferred

<!-- 比特币主要用到了密码学中的两个功能：-->
Bitcoin mainly uses two functions in cryptography:
<!-- - 哈希 -->
- Hash
<!-- - 签名 -->
- Signature

<br/>

<!-- 1. 密码学中用到的哈希函数被称为(Cryptographic Hash Function) ：--> 
1. The hash function used in cryptography is called Cryptographic Hash Function:
   <!-- 1. Collision resistance (哈希碰撞) -->
   1. Collision Resistance
      <!-- 例如 x != y， H(x) = H(y) 两个不同的输入，输出却是相等的，这就是哈希碰撞，他是不可避免的，因为输入空间总是大于输出空间。给出x很难找到y，除非蛮力求解(Brute-force) -->
      For example, x= y. H (x)=H (y) Two different inputs, but the output is equal. This is called hash collision. It is inevitable because the input space is always larger than the output space. Given x, it is difficult to find y unless brute force is solved.
      
      <!-- 该性质的作用：对一个message 求 digest -->
      The function of this property: get digest for a message.
      
      <!-- 比如message取m，m的哈希值是H(m) = digest, 如果有人想篡改m值而H(m)不变，则无法做到。-->
      For example, message takes m, and the hash value of m is H (m)=digest. If someone wants to tamper with the value of m but H (m) remains unchanged, this cannot be done.
      
      <!-- 哈希碰撞无法人为制造，无法验证，是根据实践经验得来的。-->
      Hash collision is manufactured by no one and cannot be verified. It is based on practical experience.
      
      
      
    <!-- 2. Hiding 哈希函数的计算过程是单向的，不可逆的。（从H(x)无法推导出x)hiding性质前提是输入空间足够大，分布比较均匀。如果不是足够大。一般在x后面拼接一个随机数。如H(x|| nonce) -->
    2. The calculation process of hiding hash function is unidirectional and irreversible. (It is impossible to deduce the x) Hiding property from H (x) on the premise that the input space is large enough and the distribution is relatively uniform. If it is not big enough. Generally, a random number is spliced after x. For example, H (x | | nonce).
        <!-- 该性质的作用和collision resistance结合在一起，用来实现digital commitment(digital equivalent of a sealed envelope) -->
        The function of this property is combined with the cohesion resistance to realize digital commitment (digital equivalent of a sealed envelope)
        
        <!-- 把预测结果作为输入x，算出一个哈希值，将哈希值公布，hiding让人们知道哈希值而不知道预测值，最后再将x公布，因为有collision resistance 的性质，预测结果是不可篡改的。-->
        Take the prediction result as the input x, calculate a hash value, and publish the hash value. Hiding lets people know the hash value but not the prediction value. Finally, publish the x value. Because of the collision resistance, the prediction result is not tamperable.
        
        <!-- 除了密码学中要求的两个性质外，比特币中用到的哈希函数还有第三个性质 -->
        In addition to the two properties required in cryptography, the hash function used in Bitcoin has a third property.

    <!-- 3. Puzzle friendly 指哈希值的预算事先是不可预测的，假如哈希值是00....000XX...XX, 一样事先无法知道那个值更容易算出这个结果，还是要一个一个带入。-->
   3. Puzzle friendly means that the budget of the hash value is unpredictable in advance. If the hash value is 00....000XX...XX, it is impossible to know which value is easier to calculate the result in advance, or it should be brought in one by one. 
    
      ​<!-- 比特币挖矿的过程中实际就是找一个nonce，nonce跟区块的块头里的其他信息合在一起做为输入，得出的哈希值要小于等于某个指定的目标预值，-->
      In the process of bitcoin mining, it is actually to find a nonce. The nonce is combined with other information in the block header as input, and the hash value obtained should be less than or equal to a specified target pre value.
      
      ​<!-- H(block header || nonce) <= target, block header 指块头，块头里有很多域，其中一个域是我们可以设置的随机数nonce，挖矿的过程是不停地试随机数，使得block header 取哈希后落在指定的范围之内。 -->
      H (block header | | nonce) <= target, the block header refers to the block header. There are many fields in the block header, one of which is the random number nonce that we can set. The mining process is to constantly try the random number, so that the block header falls within the specified range after hashing.
      
      <!-- puzzle friendly 是指挖矿过程中没有捷径，为了使输出值落在指定范围，只能一个一个去试，所以这个过程还可以作为工作量证明(proof of work) -->
      "Puzzle friendly" means that there is no shortcut in the mining process. In order to make the output values fall within the specified range, only one can be tried, so this process can also be used as proof of work.
      
      <!-- 挖矿很难，验证很容易(difficult to solve , but easy to verify) -->
      Difficult to solve, but easy to verify


   <!-- 比特币中用的哈希函数叫做SHA-256(secure hash algorithm)以上三个性质它都是满足的 -->
   The hash function used in Bitcoin is called SHA-256 (secure hash algorithm), which satisfies the above three properties 

   
<br/>

   <!-- 2 签名 -->
   2. Signature

      <!-- 在比特币系统中开账户: 在本地创立一个公私钥对(public key, private key)这就是一个账户，公私钥对是对来自非对称的加密技术(asymmetric encryption algorithm) -->
      Opening an account in the Bitcoin system: create a public key, private key pair locally, which is an account. The public key pair is an asymmetric encryption algorithm.
      
      <!-- 两人之间信息的交流可以利用秘钥(encryption key), A 将信息加密后发给B，B收到后用秘钥解密，因为加密和解密用的是同一密钥，所以叫堆成加密，前提是有渠道可以安全地把秘钥分发给通讯的双方，因此对称加密的缺点就是秘钥的分发不方便，因为在网络上很容易被窃听。非堆成秘钥是用一对秘钥而不是一个，加密用公钥，解密用私钥，加密和解密用的兜售接收方的公钥和私钥，公钥是不用保密的，私钥是要保密但是私钥只要保存在本地就行，不用传递给对方，公钥相当于银行账号，别人转账只要知道公钥就行，私钥相当于账户密码，知道私钥可以把账户上钱转走，公钥和私钥是用来签名。-->
      The exchange of information between two people can use the encryption key. A encrypts the information and sends it to B, and B decrypts it with the key after receiving it. Because the encryption and decryption use the same key, it is called heap encryption, provided that there are channels to securely distribute the key to both sides of the communication. Therefore, the disadvantage of symmetric encryption is that the distribution of the key is not convenient, because it is easy to eavesdrop on the network. The non heap secret key is a pair of secret keys instead of one. The public key is used for encryption, the private key for decryption, and the public key and private key for encryption and decryption are used to peddle the receiver's public key and private key. The public key is not required to be confidential. The private key is required to be confidential, but the private key is only required to be stored locally and not transferred to the other party. The public key is equivalent to a bank account number, and the private key is equivalent to an account password. Knowing the private key can transfer the money from the account, The public key and private key are used for signing.
      
      <!-- 加入A想向B转10个比特币，A把交易放在区块链上，别人怎么知道这笔交易时A发起的呢？这就需要A要用自己的私钥搞交易签名，其他人收到这笔交易后，要用A的公钥去验证签名，签名用私钥，验证用公钥，用的仍然是同一个人的，创建账户产生相同的公私钥的可能新微乎其微，所以大量创建账户来窃取其他人账户是不可行的 -->
      Joining A wants to transfer 10 bitcoins to B, and A places the transaction on the blockchain. How do others know that A initiated the transaction? This requires A to use his private key to sign the transaction. After receiving the transaction, others should use A's public key to verify the signature. The private key is used for signature and the public key is used for verification. It is still the same person's, and the possibility of creating an account to generate the same public and private key is minimal. It is not feasible to steal other people's accounts by creating a large number of accounts.
      
      <!-- 我们假设产生公私钥时有一个好的随机源（a good source of  randomness) 产生公私钥时随机的，如果随机源不好，就有可能产生相同的公私钥，比特币中用的签名算法，不仅是生成公私钥的时候要有好的随机源，之后每一次签名时也要有好的随机源，只要有一次签名用的随机源不好的话，就有可能泄露私钥。-->
      We assume that a good source of randomness is random when generating public and private keys. If the random source is not good, the same public and private keys may be generated. The signature algorithm used in Bitcoin not only requires a good random source when generating public and private keys, but also requires a good random source for each signature. As long as there is a bad random source for signing, the private key may be disclosed.

   

   